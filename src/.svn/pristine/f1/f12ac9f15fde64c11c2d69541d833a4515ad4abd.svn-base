define(['jquery','swipper','common'],function () {

	var	bindclick = function (dom,callback) {
		$('body').on('click', dom, callback);
	};
	var bindchange = function (dom,callback) {
		$("body").on('change', dom,callback);
	};
	var add_selected = function () {
		$(this).siblings().removeClass('selected')
		if ($(this).hasClass('selected')) {
			$(this).removeClass('selected');
		}else if (!$(this).hasClass('selected')) {
			$(this).addClass('selected');
		}
	}
	var add_active = function () {
		$(this).siblings().removeClass('selected')
		if ($(this).hasClass('active')) {
			$(this).removeClass('active');
		}else if (!$(this).hasClass('active')) {
			$(this).addClass('active');
		}
	}
	var stoppop = function (dom) {
		$("body").on('click', dom, function(event) {
			event.stopPropagation();
		});
	}
	//sku点击选择
	bindclick(".sku_option .pic,.sku_option .single_option",add_selected);
	bindclick(".share .download",add_active);
	stoppop(".share .download span");
	bindclick(".already_selected .selected_list",add_active);
	stoppop(".already_selected .selected_list .selected_list_detail");

	//数量选择
	var num_set =  {
		reduce: ".set_num .reduce",
		num: '.set_num .num',
		add: ".set_num .add",
		clean: "set_num .clean",
		add_func: function () {
			var temp = $(num_set.num).val();
			temp++;
			$(num_set.num).val(temp);
		},
		reduce_func: function () {
			if ($(num_set.num).val()>0) {
				var temp = $(num_set.num).val();
				temp--;
				$(num_set.num).val(temp);
			}
		},
		num_check: function () {
			var temp = $(num_set.num).val();
			if(temp<0){
				$(num_set.num).val(0)
			}
		},

		get_num: function () {
			return $(this.num).val();
		},
		init: function () {
			bindclick(this.add,this.add_func);
			bindclick(this.reduce,this.reduce_func);
			bindchange(this.num,this.num_check);
		}
	};

	var left_pic = {
		big_pic: ".show_pic .big_pic",
		smallpic_pics: ".small_pics .pics ul li",
		smallpic_ul: ".small_pics .pics ul",
		left: ".small_pics turn_left",
		right: ".small_pics turn_right",
		index: 0,
		addindex: function () {
			left_pic.index = ++left_pic.index;
			left_pic.indexcheack();
		},
		reduceindex: function () {
			left_pic.index = --left_pic.index;
			left_pic.indexcheack();
		},
		setindex : function () {
			left_pic.index = $(this).index()-1
		},
		indexcheack: function () {
			if(left_pic.index < 0){
				left_pic.index = 0;
			}
			if(left_pic.index > $(left_pic.smallpic_pics).length){
				left_pic.index = $(left_pic.smallpic_pics).length;
			}
		},
		showchange: function () {
			$(left_pic.smallpic_pics).eq(left_pic.index);
			$(left_pic.big_pic)
		}
	};
	//数量选择初始化
	num_set.init();
	

})