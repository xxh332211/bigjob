define(["jquery",'common',"modal"],function($,common,modal){
	//轮播图
	var banner_center = {
		slide: ".banner_center .banner_pics .slide_part",
		single: ".banner_center .banner_pics .slide_part .single",
		tip: ".banner_center .banner_index .main_index .indexs .index",
		index: 0,
		pic_width: 742,
		move_func : function () {
			var index = banner_center.index;
			var width = banner_center.pic_width;
			$(banner_center.slide)
			.animate({left: -index*width+"px"}, "fast");
		},
		addindex: function () {
			var index = banner_center.index;
			var limit = $(banner_center.tip).length-1;
			banner_center.index = ++index;
			if(banner_center.index>limit){
				banner_center.index = 0;
			}

		},
		tip_hover_in: function () {
			clearInterval(banner_center.timer1);
			banner_center.index = $(this).index();
			banner_center.move_func();
		},
		tip_hover_out: function () {
			banner_center.timer1 = setInterval(function (){
				banner_center.addindex();
				banner_center.move_func();
			}, 2000);
		},
		init: function () {
			banner_center.timer1 = setInterval(function (){
				banner_center.addindex();
				banner_center.move_func();
			}, 2000);
			$(banner_center.tip).hover(banner_center.tip_hover_in,banner_center.tip_hover_out);
		}
	};

	//banner右侧
	var banner_right = {
		title: ".banner_right .apply_guide_step .guide_step_content .step .step_title",
		pic: ".step_content",
		step: ".banner_right .apply_guide_step .guide_step_content .step",
		active_func: function () {
			$(this).parents(".step").addClass('active').siblings('.step').removeClass('active');
		},
		init: function () {
			$(banner_right.title).hover(banner_right.active_func);
		}
	};
	// var today_sell = {
	// 	part: ".today .today_nav .part",
	// 	page: ".today .today_content .content_product",
	// 	index: 0,
	// 	setindex: function (index) {
	// 		today_sell.index = index;
	// 	},
	// 	setactive: function () {
	// 		var index = today_sell.index;
	// 		$(today_sell.part).eq(index).addClass('active').siblings('.part').removeClass('active');
	// 		(today_sell.page).eq(index).addClass('active').siblings('.content_product').removeClass('active');
	// 	},
	// 	addindex: function () {
	// 		today_sell.index = today_sell.index + 1;
	// 	},
	// 	reduceindex: function () {
	// 		today_sell.index = today_sell.index - 1;
	// 	},
	// 	index_cheack: function () {
	// 		var limit = $(today_sell.part).length;
	// 		var index = today_sell.index;
	// 		if(index>limit){
	// 			today_sell.index = limit;
	// 		}
	// 		if(index<0){
	// 			today_sell.index = 0;
	// 		}
	// 	},
	// 	init: function () {
	// 		today_sell.setactive();
	// 	}
	// };

	//实例化弹窗
		//阿里通协议弹窗		var alitong_protocol = new modal([
				{name:"水电费地方",type:"title",content:"这是一个标题"},
				{name:"xx23h",type:"protocol",content: "te"},
				{name:"col融入i",type: "checkbox",sub:"big" ,content:"点击同意以上协议内容"},
				{name:"sdfsd",type:"option",sub:"big",text: "点击开通" ,subclass: "disable"}
			]);
			alitong_protocol.cover.find('.big').click(function(event) {
				if($(this).hasClass('disable')){
					return;
				}
				if (!$(this).hasClass('disable')){
					alitong_protocol.hidemodal()
					alitong_apply.showmodal();
				}
			});

		
		//阿里通对接表单
		var alitong_apply = new modal ([
				{name: "阿里通服务", type: "title", content: "对接平台：阿里"},
		        {name: "storeLink", text: "店铺链接", type: "input", holder: "请输入店铺链接",require:"require",cheack:"isurl",tip:"请输入正确的链接"},
		        {name: "contactName", text: "联系人", type: "input", holder: "请输入联系人",require:"require"},
		        {name: "wangwangId", text: "阿里账号", type: "input", holder: "请输入旺旺号",cheack:"isusername",tip:"请输入3-16位旺旺号",require:"require"},
		        {name: "phoneNumber", text: "电话", type: "input", cheack: "isphone", holder: "请输入电话", tip: "联系电话不正确，请重新输入",require:"require"},
		        {name: "companyName", text: "公司名称", type: "input", holder: "请输入公司名称",cheack:"isusername",tip:"请输入公司名称"},
		        {name: "wangwangId", text: "旺旺ID", type: "input", holder: "请输入旺旺号",cheack:"isusername",tip:"请输入3-16位旺旺号"},
		        {name: "submit", type: "option", sub: "cancel,sure", text: '提交'},
			]);
			alitong_apply.cover.find('.sure').click(function(event) {
				var cansend = alitong_apply.cansend();
				var memberStore = alitong_apply.getresult();
				console.log(cansend,"cansend");
				console.log(memberStore,"memberStore");
				if(alitong_apply.uptype=="yijianshangchuan"){
					//一键上传提交
					console.log("进入一键上传");
					if (cansend) {
					    //数据通过校验，转换数据格式进行ajax请求
					    memberStore = JSON.stringify(memberStore);
					    $.ajax({
					        async: true,
					        type: "POST",
					        url: "/product/memberstoreadd",
					        data: {"memberStore": memberStore},
					        success: function (result) {
					            //请求成功，跳转至阿里的铺货授权页面
					            if (result.data) {
					                window.location.href = "http://www.dawawang.com/services/alibaba.html";
					            }
					        }
					    });
					}
					return;
				}
				if(alitong_apply.uptype=="yijiandaifa"){
					//一键代发提交
					if (cansend) {
					    //数据通过校验，转换数据格式进行ajax请求
					    memberStore = JSON.stringify(memberStore);
					    $.ajax({
					        async: true,
					        type: "POST",
					        url: "/product/memberstoreadd",
					        data: {"memberStore": memberStore},
					        success: function (result) {
					            //请求成功，跳转至阿里的抓单授权页面
					            if (result.data) {
					                window.location.href = "http://www.dawawang.com/services/alibaba_product.html";
					            }
					        }
					    });
					}
					return;
				}
			});

		//登录弹窗
		var alitong_login = new modal ([
				{name:"title",type:"title",content:"用户登录"},
				{name:"username",type: "fullinput",holder:"请输入账号",icon:"&#xe61f;",cheack:"isphone",tip:"请输入注册手机号"},
				{name:"password",type: "fullinput",holder:"请输入密码",icon:"&#xe624;",cheack:"ispassword",tip:"请输入4-20位密码",sub:""},
				{name:"verifyCode",type: "fullinput",holder:"请输入验证码",icon:"&#xe622;",sub:'identify',cheack:"issms",tip:"请输入正确格式的验证码"},
				{name:"verifyCode",type: "fullinput",holder:"请输入手机验证码",icon:"&#xe622;",sub:'getcode',cheack:"issms",tip:"请输入正确格式的验证码"},
				{name:"col融入i",type: "option",sub:"big,login",link1:domain + "/forgetpassword.html",link2:domain + "/register.html",text:'点击登录'}
			]);
		//注册弹窗
		var alitong_register = new modal ([
				{name:"title",type:"title",content:"用户注册"},
				{name:"username",type: "fullinput",holder:"请输入手机号码",icon:"&#xe61f;",cheack:"isphone",tip:"请输入注册手机号"},
				{name:"password",type: "fullinput",holder:"请设置6~20位数字和字母组合的密码",icon:"&#xe624;",cheack:"ispassword",tip:"请输入4-20位密码"},
				{name:"password",type: "fullinput",holder:"请再次输入密码",icon:"&#xe624;",cheack:"ispassword",tip:"请输入4-20位密码"},
				{name:"verifyCode",type: "fullinput",holder:"请输入验证码",icon:"&#xe622;",sub:'identify',cheack:"issms",tip:"请输入正确格式的验证码"},
				{name:"verifyCode",type: "fullinput",holder:"请输入手机验证码",icon:"&#xe622;",sub:'getcode',cheack:"issms",tip:"请输入正确格式的验证码"},
				{name:"col融入i",type: "checkbox",sub:"big",classname:"r_check",content:"<div><a>《大袜网平台用户服务协议》</a><br><a>《委托付款三方协议》</a></div>"},
				{name:"sdfsd",type:"option",sub:"big",text: "立即注册" ,subclass: "disable"}
			]);
		//注册协议
			//用户服务协议
		var regist_protocol = new modal ([
				{name:"水电费地方",type:"title",content:"大袜网用户服务协议"},
				{name:"xx23h",type:"protocol",content: "te"},
				{name:"sdfsd",type:"option",sub:"big",text: "同意并继续"}
			]);
			//委托付款三方协议
		var regist_protocol_2 = new modal ([
				{name:"水电费地方",type:"title",content:"委托付款三方协议"},
				{name:"xx23h",type:"protocol",content: "te"},
				{name:"sdfsd",type:"option",sub:"big",text: "同意并继续"}
			]);

	//绑定业务逻辑
	var  procedure = {
		step_1 : ".guide_step_content .step:first-child .step_title",
		step_2 : ".guide_step_content .step:last-child .step_title",
		check_login: isUserLogin,
		step_1_func: function () {
			var _this = this;
			var islogin = procedure.check_login();
			if(islogin){ //已登录
				alitong_apply.uptype = "yijianshangchuan"
				alitong_protocol.showmodal();
			}else {
				alitong_apply.uptype = "yijianshangchuan"
				alitong_protocol.showmodal();
			}
		},
		step_2_func: function () {
			var _this = this;
			var islogin = procedure.check_login();
			if(islogin){ //已登录
				alitong_apply.uptype = "yijiandaifa"
				alitong_protocol.showmodal();
			}else {
				alitong_apply.uptype = "yijiandaifa"
				alitong_protocol.showmodal();
			}
		},
		init: function () {
			$(procedure.step_1).click(procedure.step_1_func);
			$(procedure.step_2).click(procedure.step_2_func);
		}
	};
	procedure.init();
	banner_center.init();
	banner_right.init();




	$(".search_btn").on('click',function () {
		var keyword = $(".search").val();
		window.location = domain  + "/" + "search.html?keyword=" + keyword +"&alitong=y";
    });


})